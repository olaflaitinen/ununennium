
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Production-grade Python library for satellite imagery ML">
      
      
      
        <link rel="canonical" href="https://olaflaitinen.github.io/ununennium/theory/geodesic_calculations/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Geodesic Calculations in Earth Observation: A Theoretical Treatise - Ununennium</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#geodesic-calculations-in-earth-observation-a-theoretical-treatise" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ununennium" class="md-header__button md-logo" aria-label="Ununennium" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ununennium
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Geodesic Calculations in Earth Observation: A Theoretical Treatise
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/olaflaitinen/ununennium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    olaflaitinen/ununennium
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting_started/" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/core/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/quickstart/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../models/model_zoo/" class="md-tabs__link">
        
  
  
    
  
  Model Zoo

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ununennium" class="md-nav__button md-logo" aria-label="Ununennium" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Ununennium
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/olaflaitinen/ununennium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    olaflaitinen/ununennium
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I/O
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gan_training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GAN Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/pinn_training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PINN Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/model_zoo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Zoo
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      
        Abstract
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-shape-of-the-earth-from-sphere-to-geoid" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. The Shape of the Earth: From Sphere to Geoid
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. The Shape of the Earth: From Sphere to Geoid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-the-spherical-approximation" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 The Spherical Approximation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-the-oblate-spheroid-ellipsoid-of-revolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 The Oblate Spheroid (Ellipsoid of Revolution)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2 The Oblate Spheroid (Ellipsoid of Revolution)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standard-ellipsoids" class="md-nav__link">
    <span class="md-ellipsis">
      
        Standard Ellipsoids
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-the-geoid-the-gravity-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 The Geoid (The Gravity Model)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-the-geodesic-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. The Geodesic Problem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. The Geodesic Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-the-metric-tensor" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 The Metric Tensor
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-distance-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Distance Algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Distance Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-the-haversine-spherical" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 The Haversine (Spherical)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-vincentys-formulae-iterative-ellipsoidal" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Vincenty's Formulae (Iterative Ellipsoidal)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-karneys-algorithm-2013" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Karney's Algorithm (2013)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-area-calculations-and-distortion" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Area Calculations and Distortion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Area Calculations and Distortion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-polygon-area" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Polygon Area
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-map-projection-distortion" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Map Projection Distortion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Map Projection Distortion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#latitude-weighted-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        latitude-Weighted Loss
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-coding-operations-and-rhumb-lines" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Coding Operations and Rhumb Lines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Coding Operations and Rhumb Lines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-rhumb-lines-loxodromes" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Rhumb Lines (Loxodromes)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-implementation-in-geotensor" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Implementation in geotensor
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Implementation in geotensor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-the-geodesic-buffer" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 The Geodesic Buffer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-bearing-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 Bearing Calculation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Performance Considerations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Conclusion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-references" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="geodesic-calculations-in-earth-observation-a-theoretical-treatise">Geodesic Calculations in Earth Observation: A Theoretical Treatise</h1>
<h2 id="abstract">Abstract</h2>
<p>The fundamental canvas of Earth Observation is not a flat plane, but an irregular, dynamic oblate spheroid. The naive assumption of Euclidean geometry—standard in most Computer Vision libraries—introduces catastrophic metric errors when applied to planetary scales. This document details the rigorous Geodesic Mathematics underpinning the Ununennium library. We explore the evolution of Earth models from spherical approximations to modern geoids, derive the complete solution to the Direct and Inverse Geodesic Problems (Vincenty’s and Karney’s algorithms), and analyze the non-trivial implications of ellipsoidal geometry on Deep Learning architectures, specifically regarding area distortion, directional convolution, and metric learning.</p>
<hr />
<h2 id="1-the-shape-of-the-earth-from-sphere-to-geoid">1. The Shape of the Earth: From Sphere to Geoid</h2>
<h3 id="11-the-spherical-approximation">1.1 The Spherical Approximation</h3>
<p>Historically, for navigation over short distances, Earth was approximated as a sphere of radius <span class="arithmatex">\(R \approx 6371 \text{km}\)</span>.
*   <strong>Meridional Radius:</strong> Constant.
*   <strong>Metric:</strong> Simple Spherical Trigonometry (Great Circles).
*   <strong>Error:</strong> At <span class="arithmatex">\(45^\circ\)</span> latitude, the difference between a sphere and the true ellipsoid is approx 21km in radius. This results in distance errors of up to 0.5% (~5m per km), which is unacceptable for cadastral surveying or precision agriculture.</p>
<h3 id="12-the-oblate-spheroid-ellipsoid-of-revolution">1.2 The Oblate Spheroid (Ellipsoid of Revolution)</h3>
<p>Due to rotation, centrifugal force causes the Earth to bulge at the equator and flatten at the poles. Ideally, this shape is an <strong>Oblate Spheroid</strong>.</p>
<p>Defined by two parameters:
1.  <strong>Semi-major axis (<span class="arithmatex">\(a\)</span>):</strong> Equatorial radius.
2.  <strong>Semi-minor axis (<span class="arithmatex">\(b\)</span>):</strong> Polar radius.</p>
<p><strong>Flattening (<span class="arithmatex">\(f\)</span>):</strong>
$$ f = \frac{a - b}{a} $$</p>
<p><strong>First Eccentricity (<span class="arithmatex">\(e\)</span>):</strong>
$$ e^2 = \frac{a^2 - b^2}{a^2} = 2f - f^2 $$</p>
<p><strong>Second Eccentricity (<span class="arithmatex">\(e'\)</span>):</strong>
$$ e'^2 = \frac{a^2 - b^2}{b^2} = \frac{e^2}{1-e^2} $$</p>
<h4 id="standard-ellipsoids">Standard Ellipsoids</h4>
<table>
<thead>
<tr>
<th>Ellipsoid</th>
<th><span class="arithmatex">\(a\)</span> (meters)</th>
<th><span class="arithmatex">\(1/f\)</span></th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WGS84</strong></td>
<td>6378137.0</td>
<td>298.257223563</td>
<td>GPS, Global Standard</td>
</tr>
<tr>
<td><strong>GRS80</strong></td>
<td>6378137.0</td>
<td>298.257222101</td>
<td>North America (NAD83)</td>
</tr>
<tr>
<td><strong>Airy 1830</strong></td>
<td>6377563.4</td>
<td>299.3249646</td>
<td>UK (OSGB36)</td>
</tr>
<tr>
<td><strong>Krassovsky</strong></td>
<td>6378245.0</td>
<td>298.3</td>
<td>Russia, Eastern Bloc</td>
</tr>
</tbody>
</table>
<p>Ununennium defaults to <strong>WGS84</strong> unless strictly specified otherwise by the CRS.</p>
<h3 id="13-the-geoid-the-gravity-model">1.3 The Geoid (The Gravity Model)</h3>
<p>The ellipsoid is a geometric abstraction. The physical Earth is defined by gravity. The <strong>Geoid</strong> is the equipotential surface of the Earth's gravity field that equates to Mean Sea Level (MSL) if the oceans were at rest and extended through the continents.</p>
<p>$$ h = H + N $$
*   <strong><span class="arithmatex">\(h\)</span> (Ellipsoidal Height):</strong> Native height from GPS (geometric).
*   <strong><span class="arithmatex">\(H\)</span> (Orthometric Height):</strong> Height above Sea Level (physical/gravitational).
*   <strong><span class="arithmatex">\(N\)</span> (Geoid Undulation):</strong> The separation between Ellipsoid and Geoid.</p>
<p><span class="arithmatex">\(N\)</span> ranges from -106m (in the Indian Ocean) to +85m (near Iceland).
<strong>Deep Learning Implication:</strong>
When training models on DSM/DTM (Digital Surface Models), mixing ellipsoidal heights (from raw LiDAR) with orthometric heights (from contour maps) creates significant bias. Ununennium's <code>io</code> module checks for vertical datum compatibility (e.g., EGM96 vs EGM2008).</p>
<hr />
<h2 id="2-the-geodesic-problem">2. The Geodesic Problem</h2>
<p>The shortest path between two points on an ellipsoid is a <strong>Geodesic</strong>. Unlike a Great Circle on a sphere, a geodesic on an ellipsoid does not return to its starting point; it oscillates between maximum northern and southern latitudes.</p>
<h3 id="21-the-metric-tensor">2.1 The Metric Tensor</h3>
<p>The differential distance <span class="arithmatex">\(ds\)</span> on the surface is given by the First Fundamental Form:</p>
<div class="arithmatex">\[ ds^2 = M(\phi)^2 d\phi^2 + N(\phi)^2 \cos^2\phi d\lambda^2 \]</div>
<p>Where the radii of curvature are:
*   <strong>Meridional Radius (<span class="arithmatex">\(M\)</span>):</strong> Radius of curvature along the meridian (North-South).
    $$ M(\phi) = \frac{a(1-e^2)}{(1-e^2 \sin^2\phi)^{3/2}} $$
*   <strong>Prime Vertical Radius (<span class="arithmatex">\(N\)</span>):</strong> Radius of curvature perpendicular to the meridian (East-West).
    $$ N(\phi) = \frac{a}{\sqrt{1-e^2 \sin^2\phi}} $$</p>
<p>Notably, <span class="arithmatex">\(M(\phi)\)</span> varies by ~1% from pole to equator. A "degree of latitude" is longer at the poles (<span class="arithmatex">\(111.7\)</span> km) than at the equator (<span class="arithmatex">\(110.6\)</span> km). This 1.1km discrepancy per degree is the primary source of error in spherical assumptions.</p>
<hr />
<h2 id="3-distance-algorithms">3. Distance Algorithms</h2>
<h3 id="31-the-haversine-spherical">3.1 The Haversine (Spherical)</h3>
<p>Fast, differentiable, but inaccurate (<span class="arithmatex">\(0.5\%\)</span> error).</p>
<div class="arithmatex">\[ \theta = 2 \arcsin \sqrt{\sin^2\left(\frac{\Delta\phi}{2}\right) + \cos\phi_1 \cos\phi_2 \sin^2\left(\frac{\Delta\lambda}{2}\right)} $$
$$ d = R \cdot \theta \]</div>
<p>Used in Ununennium only for "Quick Look" operations or lightweight neighbor search.</p>
<h3 id="32-vincentys-formulae-iterative-ellipsoidal">3.2 Vincenty's Formulae (Iterative Ellipsoidal)</h3>
<p>Vincenty (1975) proposed an iterative solution to the inverse problem accurate to <span class="arithmatex">\(0.5\)</span> mm.</p>
<p><strong>Algorithm (Inverse Problem):</strong>
Given <span class="arithmatex">\((\phi_1, \lambda_1)\)</span> and <span class="arithmatex">\((\phi_2, \lambda_2)\)</span>, find distance <span class="arithmatex">\(s\)</span> and azimuths <span class="arithmatex">\(\alpha_1, \alpha_2\)</span>.</p>
<ol>
<li>Compute reduced latitudes: <span class="arithmatex">\(U_1 = \arctan((1-f)\tan\phi_1)\)</span>, <span class="arithmatex">\(U_2 = \arctan((1-f)\tan\phi_2)\)</span>.</li>
<li>Initialize longitude difference on auxiliary sphere <span class="arithmatex">\(\Lambda = \lambda_2 - \lambda_1\)</span>.</li>
<li>
<p><strong>Iterate until convergence (<span class="arithmatex">\(\Delta \Lambda &lt; 10^{-12}\)</span>):</strong></p>
<ul>
<li><span class="arithmatex">\(\sin\sigma = \sqrt{(\cos U_2 \sin\Lambda)^2 + (\cos U_1 \sin U_2 - \sin U_1 \cos U_2 \cos \Lambda)^2}\)</span></li>
<li><span class="arithmatex">\(\cos\sigma = \sin U_1 \sin U_2 + \cos U_1 \cos U_2 \cos \Lambda\)</span></li>
<li><span class="arithmatex">\(\sigma = \arctan2(\sin\sigma, \cos\sigma)\)</span></li>
<li><span class="arithmatex">\(\sin\alpha = \frac{\cos U_1 \cos U_2 \sin \Lambda}{\sin\sigma}\)</span></li>
<li><span class="arithmatex">\(\cos^2\alpha = 1 - \sin^2\alpha\)</span></li>
<li><span class="arithmatex">\(\cos(2\sigma_m) = \cos\sigma - \frac{2\sin U_1 \sin U_2}{\cos^2\alpha}\)</span> (handle division by zero if equatorial)</li>
<li><span class="arithmatex">\(C = \frac{f}{16} \cos^2\alpha [4 + f(4 - 3\cos^2\alpha)]\)</span></li>
<li><span class="arithmatex">\(\Lambda_{new} = L + (1-C)f\sin\alpha \{ \sigma + C\sin\sigma [\cos(2\sigma_m) + C\cos\sigma(-1 + 2\cos^2(2\sigma_m))] \}\)</span></li>
</ul>
</li>
<li>
<p>Calculate <span class="arithmatex">\(s\)</span> using Bessel's formula corrections.</p>
</li>
</ol>
<p><strong>Limitations:</strong>
Vincenty's iteration fails to converge for nearly antipodal points (opposite sides of the Earth).</p>
<h3 id="33-karneys-algorithm-2013">3.3 Karney's Algorithm (2013)</h3>
<p>Charles Karney solved the antipodal convergence problem using a generalized series expansion.
*   <strong>Accuracy:</strong> 15 nm (nanometers).
*   <strong>Ununennium Implementation:</strong> We wrap the <code>geographiclib</code> C++ implementation via <code>pyproj</code> for maximum speed and stability. All critical <code>measure_distance</code> calls in the library use Karney's method.</p>
<hr />
<h2 id="4-area-calculations-and-distortion">4. Area Calculations and Distortion</h2>
<p>Calculating area on the ellipsoid requires integration of the Gaussian curvature.</p>
<h3 id="41-polygon-area">4.1 Polygon Area</h3>
<p>The area of a geodesic polygon is given by the discrete sum of excesses.
$$ A = \sum_{edges} (Area under geodesic segment) $$
This uses the Danielsen (1989) integrals involving Fourier series expansions of the oscillatory terms.</p>
<h3 id="42-map-projection-distortion">4.2 Map Projection Distortion</h3>
<p>Deep Learning models (CNNs) operate on raster grids, which are planar projections of the ellipsoid.
$$ (x, y) = P(\phi, \lambda) $$</p>
<p><strong>Tissot's Indicatrix</strong> describes the distortion at any point.
1.  <strong>Conformal Projections (e.g., Mercator, stereographic):</strong>
    *   Preserve Angles (Shapers). A circle on Earth <span class="arithmatex">\(\to\)</span> Circle on Map.
    *   Distort Area. <span class="arithmatex">\(Scale \propto \sec(\phi)\)</span>.
    *   <em>Issue:</em> A pixel at 60°N represents <span class="arithmatex">\(4\times\)</span> less real-world area than a pixel at the Equator. A "House" class at 60°N looks 4x bigger (in pixels) than a "House" at the Equator.</p>
<ol>
<li><strong>Equal-Area Projections (e.g., Albers Conic, Gall-Peters):</strong><ul>
<li>Preserve Area.</li>
<li>Distort Shape (Shearing).</li>
<li><em>Issue:</em> Objects are squashed or stretched. Rotation-variant CNNs may fail to recognize a squashed building.</li>
</ul>
</li>
</ol>
<p><strong>Ununennium Strategy:</strong>
We strongly recommend <strong>Equal-Area</strong> projections (like Albers or Sinusoidal) for statistical reporting (e.g., "Total Deforested Area"). For training, if the AOI is global, we implement <strong>Dynamic Scale Augmentation</strong> or <strong>Latitude-Weighted Loss</strong>.</p>
<h4 id="latitude-weighted-loss">latitude-Weighted Loss</h4>
<p>To counter Mercator distortion in global models:
$$ w(pixel) = \frac{A_{true}}{A_{map}} = \cos(\phi) $$
We downweight high-latitude pixels because 1 "map meter" corresponds to fewer "real meters".</p>
<hr />
<h2 id="5-coding-operations-and-rhumb-lines">5. Coding Operations and Rhumb Lines</h2>
<h3 id="51-rhumb-lines-loxodromes">5.1 Rhumb Lines (Loxodromes)</h3>
<p>A path of constant bearing (azimuth). On a Mercator projection, this is a straight line.
*   <strong>Geodesic:</strong> Shortest path (Curved on map).
*   <strong>Rhumb Line:</strong> Constant compass heading (Straight on map).</p>
<p><strong>Use Case in AI:</strong>
Tracking ships in AIS (Automatic Identification System) data. Ships often follow Rhumb lines (constant heading) rather than Geodesics (requires constant steering adjustment). Predicting vessel trajectories using LSTM/Transformers requires discerning the navigation mode.</p>
<hr />
<h2 id="6-implementation-in-geotensor">6. Implementation in <code>geotensor</code></h2>
<p>The <code>GeoTensor</code> class enables algebraic operations that respect geodetic reality.</p>
<h3 id="61-the-geodesic-buffer">6.1 The Geodesic Buffer</h3>
<p><code>GeoTensor.buffer(distance_meters)</code>
Naive buffering (dilating by <span class="arithmatex">\(N\)</span> pixels) creates circles of varying physical sizes depending on latitude.
Ununennium computes the buffer in the Geodetic space and rasterizes it back, ensuring a 50m buffer is exactly 50m everywhere.</p>
<h3 id="62-bearing-calculation">6.2 Bearing Calculation</h3>
<p><code>GeoTensor.bearing_to(other_tensor)</code>
Calculates the forward azimuth <span class="arithmatex">\(\alpha_1\)</span> for every pixel to a target.
*   <strong>Input:</strong> Two <span class="arithmatex">\((B, H, W)\)</span> tensors of lat/lons.
*   <strong>Output:</strong> One <span class="arithmatex">\((B, H, W)\)</span> tensor of bearings <span class="arithmatex">\([0, 360)\)</span>.
*   <strong>Math:</strong> Uses vectorised <code>atan2</code> on the sphere (or Vincenty for precision).</p>
<div class="arithmatex">\[ \theta = \operatorname{atan2}(\sin\Delta\lambda \cdot \cos\phi_2, \cos\phi_1 \cdot \sin\phi_2 - \sin\phi_1 \cdot \cos\phi_2 \cdot \cos\Delta\lambda) \]</div>
<hr />
<h2 id="7-performance-considerations">7. Performance Considerations</h2>
<p>Ellipsoidal math is computationally expensive.
*   <strong>Haversine:</strong> ~20 FLOPS.
*   <strong>Vincenty:</strong> ~2000 FLOPS (Iterative).
*   <strong>Karney:</strong> ~3000 FLOPS.</p>
<p><strong>Batching Strategy:</strong>
For heavy metric learning (e.g., Geodesic Triplet Loss), calculating exact geodesic distances matrix-wise <span class="arithmatex">\((N \times N)\)</span> is too slow.
<strong>Approximation:</strong>
We project local batches to an <strong>Azimuthal Equidistant Projection</strong> centered on the batch centroid. In this local projected space, Euclidean distance <span class="arithmatex">\(\approx\)</span> Geodesic distance.
$$ d_{geo}(x, y) \approx | P_{local}(x) - P_{local}(y) |_2 $$
This reduces complexity to <span class="arithmatex">\(O(1)\)</span> per pair, allowing massive batch sizes.</p>
<hr />
<h2 id="8-conclusion">8. Conclusion</h2>
<p>Geometry is the physics of geospatial data. Ununennium refuses to treat Earth as a plane. By implementing rigorous WGS84 ellipsoidal mathematics (Karney/Vincenty) and handling projection distortions explicitly, we ensure that the Deep Learning models we build are not just pattern matchers, but physical measurement instruments.</p>
<hr />
<h2 id="9-references">9. References</h2>
<ol>
<li><strong>Vincenty, T. (1975).</strong> "Direct and Inverse Solutions of Geodesics on the Ellipsoid with application of nested equations". <em>Survey Review</em>, 23(176), 88-93.</li>
<li><strong>Karney, C. F. F. (2013).</strong> "Algorithms for geodesics". <em>Journal of Geodesy</em>, 87(1), 43-55.</li>
<li><strong>Snyder, J. P. (1987).</strong> <em>Map Projections: A Working Manual</em>. USGS Professional Paper 1395.</li>
<li><strong>Danielsen, J. (1989).</strong> "The Area under the Geodesic". <em>Survey Review</em>, 30(232), 61-66.</li>
<li><strong>Tissot, N. A. (1859).</strong> <em>Mémoire sur la représentation des surfaces et les projections des cartes géographiques</em>.</li>
<li><strong>Rapp, R. H. (1991).</strong> <em>Geometric Geodesy, Part I</em>. Ohio State University Department of Geodetic Science.</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>